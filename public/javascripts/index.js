"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t){var n={};for(var o in t)if(a(t[o])){n[o]=[];for(var i in t[o])n[o].push(t[o][i])}else t.hasOwnProperty(o)&&(n[o]="object"==_typeof(t[o])?e(t[o]):t[o]);return n}function n(t,n,o,i){i&&(t=e(t)),o=o||this;for(var a in t)if(!t.hasOwnProperty(a)||0==n.call(o,t[a],a))break}function o(t,e,i,l){var s;if(a(e))n(e,function(e,n){i||rbracket.test(t)?l(t,e):o(t+"["+("object"===("undefined"==typeof e?"undefined":_typeof(e))&&null!=e?n:"")+"]",e,i,l)});else if(i||"object"!==("undefined"==typeof e?"undefined":_typeof(e)))l(t,e);else for(s in e)o(t+"["+s+"]",e[s],i,l)}var i=function(t,e,n){var o=function(t,e,n){var o=this,i=function n(){var o=this;this.isout||setTimeout(function(){t(),n.call(o)},e)};setTimeout(function(){i.call(o)},n||0)};return new o(t,e,n)};i.cancel=function(t){t.isout=!0,t=void 0};var a=function(t){return t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&Array==t.constructor},l=new XMLHttpRequest,s=function(t,e){var i,l=[],s=function(t,e){var n="function"==typeof e?e():e;l[l.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(a(t)||t.jquery&&!jQuery.isPlainObject(t))n(t,function(t){s(t.name,t.value)});else for(i in t)o(i,t[i],e,s);return l.join("&")},c=function(t){var e=!t.async||!1;l.open(t.type||"GET",t.url,e),l.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=utf-8"),l.send(s(t.data||{})),l.onreadystatechange=function(){if(4===l.readyState&&200===l.status&&t.success&&t.success(JSON.parse(l.responseText)),404===l.status)throw"地址没有找到!"}},r=$,u=function(){this.container=document.querySelector(".xly-layer"),this.bg=this.container.querySelector(".lay-bg"),this.modal=this.container.querySelector(".lay-modal"),this.text=this.container.querySelector(".lay-textContent")};u.prototype={show:function(t,e){var n=this;this.text.textContent=t,this.container.style.display="flex",this.modal.style.left=this.container.offsetWidth/2-this.modal.offsetWidth/2+"px",this.modal.style.transition="0s",this.modal.style.top=this.container.offsetHeight/2+100+"px",this.modal.style.transform="scale(0.5)",setTimeout(function(){n.modal.style.transition=".4s",n.modal.style.transform="scale(1)",n.modal.style.top=n.container.offsetHeight/2-n.modal.offsetHeight/2+"px",n.container.className="xly-layer in",setTimeout(function(){n.modal.style.transform="scale(0.5)",n.modal.style.top=n.container.offsetHeight/2-100+"px",n.container.className="xly-layer out",setTimeout(function(){n.container.style.display="none",e&&e()},400)},2e3)},10)}};var f=function(){function t(){_classCallCheck(this,t),console.log("你好"),console.log("执行了");document.querySelector("header.header")}return _createClass(t,[{key:"logindialog",value:function(){function t(){i.className="login-dialog-container out",setTimeout(function(){i.style.display="none"},400)}var e=document.querySelectorAll(".tab-btn"),o=document.querySelectorAll(".login-modal form");n(e,function(t,i){t.addEventListener("click",function(){n(o,function(t,n){e[n].className="tab-btn",t.style.display="none"}),o[i].style.display="block",e[i].className="tab-btn active"})});var i=$(".login-dialog-container")[0],a=$(".login-bg")[0],l=$("#login-btn")[0],s=$(".login-dialog-container .close-dialog")[0];l&&l.addEventListener("click",function(){i.style.display="flex",setTimeout(function(){i.className="login-dialog-container in"},10)}),a.addEventListener("click",t),s.addEventListener("click",t);var r=$(".login-form")[0],f=$(".login-form .login-btn")[0],d=new u;f.addEventListener("click",function(){c({type:"POST",url:"/login",data:{username:r.username.value,pwd:r.password.value,autologin:r.autologin.checked},success:function(t){t.status?d.show("登录成功!^_^",function(){location.reload()}):d.show("用户名或密码错误!T T")}})})}},{key:"home",value:function(){function t(){o.scrollTop>=50&&l-o.scrollTop>=50?(a.removeClass("fixb"),a.addClass("fixt")):l-o.scrollTop<50?(a.removeClass("fixt"),a.addClass("fixb")):(o.scrollTop<50||l-o.scrollTop<50)&&(a.removeClass("fixt"),a.removeClass("fixb"))}console.clear();var e=r(".pageload-img"),n=jQuery;window.onload=function(){e.fadeOut(500),setTimeout(function(){e.remove()},500)};var o=n("body")[0],i=n(".background-imgA"),a=n(".page-container .left_bg"),l=o.scrollHeight-i[0].offsetHeight;t(),window.onscroll=t,this.logindialog()}},{key:"newpost",value:function(){function t(){s>=10?i.attr("disabled","disabled"):i.removeAttr("disabled")}console.clear(),wangEditor.config.printLog=!1;var e=new wangEditor("editor-trigger");e.config.uploadImgUrl="/editorimg",e.config.uploadParams={},e.config.uploadHeaders={},e.config.emotionsShow="value",e.onchange=function(){console.log(this.$txt.html())},e.create();var n=$("#subPost"),o=new u,i=$(".addnew-tabbtn"),a='<div class="tabs"><span class="fontello icon-tabs"></span><input type="text" required placeholder="标签"><span class="fontello icon-trash-empty"></span></div>',l=$(".tabs-num"),s=0;i.on("click",function(){var e=$(a);e.find(".icon-trash-empty").on("click",function(){e.remove(),s--,l.text(s),t()}),$(this).before(e),s++,l.text(s),t()}),n.on("click",function(){var t=$(".tabs input"),n="";t.each(function(){""!=this.value&&(n+=this.value+",")}),n=n.replace(/,$/,""),console.log(n);var i={title:$("#post-title").val(),content:e.$txt.html(),tabs:n};console.log(i),c({type:"POST",url:"/newpost",data:i,success:function(t){t.status?o.show(t.msg,function(){location.reload()}):o.show(t.msg)}})})}},{key:"postContent",value:function(){this.logindialog()}}]),t}(),d=new f,y=document.querySelector("[y_ctrl]");y&&(y=y.getAttribute("y_ctrl")),d[y]&&d[y]()}(window);