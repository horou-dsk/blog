"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t){var n={};for(var o in t)if(s(t[o])){n[o]=[];for(var i in t[o])n[o].push(t[o][i])}else t.hasOwnProperty(o)&&(n[o]="object"==_typeof(t[o])?e(t[o]):t[o]);return n}function n(t,n,o,i){i&&(t=e(t)),o=o||this;for(var a in t)if(!t.hasOwnProperty(a)||0==n.call(o,t[a],a))break}function o(t,e,i,a){var l;if(s(e))n(e,function(e,n){i||rbracket.test(t)?a(t,e):o(t+"["+("object"===("undefined"==typeof e?"undefined":_typeof(e))&&null!=e?n:"")+"]",e,i,a)});else if(i||"object"!==("undefined"==typeof e?"undefined":_typeof(e)))a(t,e);else for(l in e)o(t+"["+l+"]",e[l],i,a)}function i(t){var e=new RegExp("(\\?|&)"+t+"=([^&]*)(&|$)","i"),n=location.search.match(e);return n&&n.length>=3?n[2]:null}var a=function(t,e,n){var o=function(t,e,n){var o=this,i=function n(){var o=this;this.isout||setTimeout(function(){t(),n.call(o)},e)};setTimeout(function(){i.call(o)},n||0)};return new o(t,e,n)};a.cancel=function(t){t.isout=!0,t=void 0};var s=function(t){return t&&"object"===("undefined"==typeof t?"undefined":_typeof(t))&&Array==t.constructor},l=new XMLHttpRequest,r=function(t,e){var i,a=[],l=function(t,e){var n="function"==typeof e?e():e;a[a.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(s(t)||t.jquery&&!jQuery.isPlainObject(t))n(t,function(t){l(t.name,t.value)});else for(i in t)o(i,t[i],e,l);return a.join("&")},c=function(t){var e=!t.async||!1;l.open(t.type||"GET",t.url,e),l.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=utf-8"),l.send(r(t.data||{})),l.onreadystatechange=function(){if(4===l.readyState&&200===l.status&&t.success&&t.success(JSON.parse(l.responseText)),404===l.status)throw"地址没有找到!"}},u=$,f=function(){this.container=document.querySelector(".xly-layer"),this.bg=this.container.querySelector(".lay-bg"),this.modal=this.container.querySelector(".lay-modal"),this.text=this.container.querySelector(".lay-textContent")};f.prototype={show:function(t,e){var n=this;this.text.textContent=t,this.container.style.display="flex",this.modal.style.left=this.container.offsetWidth/2-this.modal.offsetWidth/2+"px",this.modal.style.transition="0s",this.modal.style.top=this.container.offsetHeight/2+100+"px",this.modal.style.transform="scale(0.5)",setTimeout(function(){n.modal.style.transition=".4s",n.modal.style.transform="scale(1)",n.modal.style.top=n.container.offsetHeight/2-n.modal.offsetHeight/2+"px",n.container.className="xly-layer in",setTimeout(function(){n.modal.style.transform="scale(0.5)",n.modal.style.top=n.container.offsetHeight/2-100+"px",n.container.className="xly-layer out",setTimeout(function(){n.container.style.display="none",e&&e()},400)},2e3)},10)}};var d=function(){function t(){_classCallCheck(this,t),console.log("你好"),console.log("执行了");document.querySelector("header.header")}return _createClass(t,[{key:"logindialog",value:function(){function t(){a.className="login-dialog-container out",setTimeout(function(){a.style.display="none"},400)}function e(){c({type:"POST",url:"/login",data:{username:u.username.value,pwd:u.password.value,autologin:u.autologin.checked},success:function(t){t.status?y.show(t.msg,function(){location.reload()}):y.show(t.msg)}})}var o=document.querySelectorAll(".tab-btn"),i=document.querySelectorAll(".login-modal form");n(o,function(t,e){t.addEventListener("click",function(){n(i,function(t,e){o[e].className="tab-btn",t.style.display="none"}),i[e].style.display="block",o[e].className="tab-btn active"})});var a=$(".login-dialog-container")[0],s=$(".login-bg")[0],l=$("#login-btn")[0],r=$(".login-dialog-container .close-dialog")[0];l&&l.addEventListener("click",function(){a.style.display="flex",setTimeout(function(){a.className="login-dialog-container in"},10)}),s.addEventListener("click",t),r.addEventListener("click",t);var u=$(".login-form")[0],d=$(".login-form .login-btn")[0],y=new f;u.password.addEventListener("keypress",function(t){13===t.keyCode&&e()}),d.addEventListener("click",e)}},{key:"home",value:function(){function t(){o.scrollTop>=50&&s-o.scrollTop>=50?(a.removeClass("fixb"),a.addClass("fixt")):s-o.scrollTop<50?(a.removeClass("fixt"),a.addClass("fixb")):(o.scrollTop<50||s-o.scrollTop<50)&&(a.removeClass("fixt"),a.removeClass("fixb"))}console.clear();var e=u(".pageload-img"),n=jQuery;window.onload=function(){e.fadeOut(500),setTimeout(function(){e.remove()},500)};var o=n("body")[0],i=n(".background-imgA"),a=n(".page-container .left_bg"),s=o.scrollHeight-i[0].offsetHeight;t(),window.onscroll=t,this.logindialog()}},{key:"newpost",value:function(){function t(){$(this).parent().remove(),y--,d.text(y),e()}function e(){y>=10?r.attr("disabled","disabled"):r.removeAttr("disabled")}function n(){var n=$(u);n.find(".icon-trash-empty").on("click",t),$(this).before(n),y++,d.text(y),e()}function o(){var t=$(".tabs input"),e="",n=!0;if(t.each(function(){if(""!=this.value){if(/[?*\[\],+=_\-()&^%$#@!~`.\/\\]/.test(this.value))return n=!1,!1;e+=this.value+","}}),!n)return void l.show("标签不能包含特殊符号!");e=e.replace(/,$/,"");var o={title:$("#post-title").val(),content:a.$txt.html(),tabs:e,ptid:p};c({type:"POST",url:"/newpost",data:o,success:function(t){t.status?l.show(t.msg,function(){location.reload()}):l.show(t.msg)}})}console.clear(),wangEditor.config.printLog=!1;var a=new wangEditor("editor-trigger");a.config.uploadImgUrl="/editorimg",a.config.uploadParams={},a.config.uploadHeaders={},a.config.emotionsShow="value",a.onchange=function(){console.log(this.$txt.html())},a.create();var s=$("#subPost"),l=new f,r=$(".addnew-tabbtn"),u='<div class="tabs"><span class="fontello icon-tabs"></span><input type="text" required placeholder="标签"><span class="fontello icon-trash-empty"></span></div>',d=$(".tabs-num"),y=$(".tabs input").length;d.text(y),$(".tabs .icon-trash-empty").on("click",t);var p=i("ptid");r.on("click",n),s.on("click",o)}},{key:"postContent",value:function(){this.logindialog()}}]),t}(),y=new d,p=document.querySelector("[y_ctrl]");p&&(p=p.getAttribute("y_ctrl")),y[p]&&y[p]()}(window);